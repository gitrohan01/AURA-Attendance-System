{% extends "attendance/base.html" %}
{% block title %}Teacher Dashboard — AURA{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold text-sky-400 mb-6">Teacher Dashboard</h1>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6">

    <!-- Classes -->
    <div class="bg-white/5 p-5 rounded-xl shadow-lg border border-white/10">
        <h2 class="text-xl font-semibold mb-3">Your Classes</h2>
        <div class="space-y-2">
            {% for c in classes %}
            <a href="{% url 'teacher_class_detail' c.id %}" class="block p-3 rounded bg-white/5 hover:bg-white/10 transition">
                {{ c.name }} — {{ c.department.name }}
            </a>
            {% empty %}
            <p class="text-gray-400">No classes assigned.</p>
            {% endfor %}
        </div>
    </div>

    <!-- Subjects -->
    <div class="bg-white/5 p-5 rounded-xl shadow-lg border border-white/10">
        <h2 class="text-xl font-semibold mb-3">Your Subjects</h2>
        <ul class="space-y-1">
            {% for s in subjects %}
            <li class="p-2 bg-white/5 rounded">{{ s.name }} ({{ s.code }})</li>
            {% empty %}
            <p class="text-gray-400">No subjects assigned.</p>
            {% endfor %}
        </ul>
    </div>

</div>

<!-- Weekly Chart -->
<div class="mt-10 bg-white/5 p-6 rounded-xl border border-white/10">
    <h2 class="font-semibold mb-4">Last 7 Days Attendance</h2>
    <canvas id="weeklyChart" height="120"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
fetch("{% url 'teacher_weekly_stats' %}")
.then(res => res.json())
.then(data => {
    new Chart(document.getElementById("weeklyChart"), {
        type: "line",
        data: {
            labels: data.labels,
            datasets: [
                { label: "Present", data: data.present, borderWidth: 2, borderColor: "rgb(59,130,246)" },
                { label: "Absent", data: data.absent, borderWidth: 2, borderColor: "rgb(239,68,68)" }
            ]
        }
    })
})
</script>

{% endblock %}
